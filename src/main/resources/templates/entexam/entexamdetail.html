<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.springframework.org/schema/security"
      xmlns:layout="http://www.w3.org/1999/xhtml">
<head>
    <!--    <meta name="_csrf" content="${_csrf.token}"/>-->
    <!--    <meta name="_csrf_header"  content="${_csrf.headerName}"/>-->
    <meta id="_csrf" name="_csrf" th:content="${_csrf.token}"/>
    <meta id="_csrf_header" name="_csrf_header" th:content="${_csrf.headerName}"/>
    <meta charset="UTF-8">
    <title>ğŸ¸MomsWay - ì…ì‹œ</title>
    <link rel="stylesheet" th:href="@{/css/board/boarddetail.css}">
    <link rel="stylesheet" th:href="@{/css/entexam/entdetail.css}">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">
    <link rel="stylesheet" th:href="@{/css/entexam/entmodal.css}">
    <script src="https://kit.fontawesome.com/4e5b2f86bb.js" crossorigin="anonymous"></script>
    <script defer th:src="@{/js/header.js}"></script>
    <script th:src="@{/js/entexam/entupdate.js}"></script>
    <script th:src="@{/js/entexam/entexamdetail.js}"></script>
    <script th:src="@{/js/entexam/entreply.js}"></script>
    <script th:src="@{/js/entexam/entlike.js}"></script>
    <script th:src="@{/js/entexam/entreport.js}"></script>
    <script th th:inline="javascript">
        document.addEventListener("DOMContentLoaded", function () {
            init([[${dto.eid}]]);
            window.entreply.init(eid)
            window.entlike.init(eid)
            let username = [[${#authentication.principal.username}]]
            console.log(username);
        })
    </script>
</head>
<body>
<header layout:fragment="header" th:replace="~{header :: header_template}"></header>
<div id="wrap">
    <div class="boarddetailwrap">
        <div class="dttop">
            <span th:text="${dto.title}"></span>
            <input type="hidden" th:id="eid" th:value="${dto.eid}">
            <th:block
                    th:if="${#authentication.name.equals(dto.email) or #authorization.expression('hasRole(''ADMIN'')')}">
                <button type="submit" id="mod">ìˆ˜ì •</button>
                <button type="button" id="del" th:onclick="delEnt()">ì‚­ì œ</button>
            </th:block>
        </div>
        <div class="dtbody">
            <div class="dtinfo">
                <span class="infowriter" th:text="${dto.nickname}"></span>
                <div class="readdate">
                    <span th:text="|ì¡°íšŒ ${dto.readNo}|"></span>
                    <span th:text="${#temporals.format(dto.createAt,'yyyy-MM-dd HH:mm')}"></span>
                    <button th:if="${!#authentication.name.equals(dto.email)}" type="button" class="reportbtn"
                            onclick="document.getElementById('reportModal').style.display='block'">ì‹ ê³ í•˜ê¸°
                    </button>
                </div>
            </div>
            <div class="dtcontent">
                <th:block th:each="img:${dto.imgPath}">
                    <img th:src="@{'/getentimages/'+${img}}" alt="img">
                </th:block>
                <p th:text="${dto.content}"></p>
            </div>
            <div class="func">
                <img th:src="@{'/images/like.png'}" th:id="likeBtn" th:onclick="toggleLike()">
                <span>ë§ˆìŒì— ë“ ë‹¤ë©´?</span>
            </div>
            <div id="reportModal" style="display:none;">
                <div class="modal">
                    <h2>ì‹ ê³ í˜ì´ì§€</h2>
                    <p class="reportp">ì‹ ê³  í•˜ëŠ” ì´ìœ ë¥¼ ì…ë ¥í•˜ê³  ì‹ ê³  ì œì¶œì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</p>
                    <input type="hidden" id="reportEid" th:value="${dto.eid}">
                    <input type="hidden" id="reportUid" th:value="${dto.uid}">
                    <textarea id="comment" name="comment" placeholder="ì‹ ê³  í•˜ëŠ” ì´ìœ ë¥¼ ì ì–´ì£¼ì„¸ìš”"></textarea>
                    <button type="button" class="reportbtn reportbtn1" onclick="entReport()">ì‹ ê³  ì œì¶œ</button>
                    <button type="button" class="reset"
                            onclick="document.getElementById('reportModal').style.display='none'">ë‹«ê¸°
                    </button>
                </div>
            </div>
            <div class="tolist">
                <a href="/entexam">ëª©ë¡ìœ¼ë¡œ</a>
            </div>
        </div>
        <div class="comarea">
            <ul>
                <li class="cominput">
                    <input type="text" name="content" id="content" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”">
                    <button id="submit" type="button">ë“±ë¡</button>
                </li>
            </ul>
            <div th:id="comments">
                <h2>ëŒ“ê¸€</h2>
                <ul th:id="comments-list"></ul>
            </div>
        </div>
    </div>
</div>
<footer layout:fragment="footer" th:replace="~{footer :: footer_template}"></footer>
</body>
</html>